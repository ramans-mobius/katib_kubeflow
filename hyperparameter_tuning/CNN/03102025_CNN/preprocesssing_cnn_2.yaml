name: Simple Data Preprocessing
description: Basic data preprocessing for testing

inputs:
  - name: data_path
    type: String
    description: Path to data
    
  - name: batch_size
    type: Integer
    description: Batch size
    default: 32

outputs:
  - name: processed_data_path
    type: string
    description: Path to processed data

implementation:
  container:
    image: python:3.9
    command:
    - python3
    - -c
    - |
      import os
      import sys
      
      print("=== SIMPLE PREPROCESSING ===")
      print(f"Data path: {sys.argv[1]}")
      print(f"Batch size: {sys.argv[2]}")
      
      # Create output directory
      output_path = os.path.join(sys.argv[1], 'processed')
      os.makedirs(output_path, exist_ok=True)
      
      # Write output file
      with open(sys.argv[3], 'w') as f:
          f.write(output_path)
      
      print(f"Output path: {output_path}")
      print("=== COMPLETED ===")
    
    args:
    - --data_path
    - {inputValue: data_path}
    - --batch_size
    - {inputValue: batch_size}
    - --processed_data_path
    - {outputPath: processed_data_path}
