name: universal_cnn_preprocessor
description: Universal data loader supporting torchvision datasets, URLs, and multiple archive formats

inputs:
  - name: data_info
    type: dict
    description: Dictionary containing dataset information including path and num_classes

  - name: raw_data_path
    type: String
    description: Path to raw downloaded/extracted data

  - name: model_config
    type: String
    description: Complete model configuration as JSON string
    default: "{\"layers\": [{\"type\": \"conv\", \"out_channels\": 32, \"kernel_size\": 3, \"padding\": 1, \"batch_norm\": true, \"dropout\": 0.1}, {\"type\": \"maxpool\", \"kernel_size\": 2}, {\"type\": \"conv\", \"out_channels\": 64, \"kernel_size\": 3, \"padding\": 1, \"batch_norm\": true, \"dropout\": 0.2}, {\"type\": \"maxpool\", \"kernel_size\": 2}, {\"type\": \"conv\", \"out_channels\": 128, \"kernel_size\": 3, \"padding\": 1, \"batch_norm\": true, \"dropout\": 0.3}, {\"type\": \"maxpool\", \"kernel_size\": 2}], \"fc_layers\": [256, 128], \"fc_dropout\": 0.5, \"optimizer\": {\"type\": \"adam\", \"lr\": 0.001}, \"epochs\": 10, \"batch_size\": 64, \"dataset\": \"mnist\", \"validation_split\": 0.2, \"task_type\": \"classification\"}"

outputs:
  - name: data_info
    type: dict
    description: Dictionary containing dataset information including path and num_classes
  - name: raw_data_path
    type: string
    description: Path to raw downloaded/extracted data

implementation:
  language: "python"
  source: |
    import os
    import urllib.request
    import tarfile
    import zipfile
    import json
    import pickle
